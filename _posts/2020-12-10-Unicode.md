---
title: ä¸€ç‚¹å…³äºUnicodeçš„çŸ¥è¯†
author: Yibin Yang
tag: unicode utf-8 utf-16 utf-32
---
æœ€è¿‘èŠ±äº†ç‚¹æ—¶é—´äº†è§£äº†ä¸‹UnicodeåŠå…¶ç¼–ç çš„ç›¸å…³çŸ¥è¯†ï¼Œæ€»ç»“å¦‚ä¸‹ï¼š

**ä¸€ç‚¹å†å²**

ASCII codeå’ŒUnicodeæ˜¯ä¸–ç•Œä¸Šåº”ç”¨æœ€å¹¿æ³›çš„ä¸¤ç§ç¼–ç æ–¹æ¡ˆã€‚ASCII codeèŒƒå›´ä»0-127ï¼Œå…¶ä¸­0-31æ˜¯æ§åˆ¶å­—èŠ‚ã€‚ASCII codeå¯ä»¥ç”¨ä¸€ä¸ªå­—èŠ‚è¡¨ç¤ºï¼Œç”±äºç¼–ç åªéœ€è¦ä½ä½çš„7ä¸ªbitï¼Œæ‰€ä»¥å„ä¸ªå›½å®¶åœ°åŒºå¯¹å¦‚ä½•ä½¿ç”¨å¤§äº127çš„ç¼–ç ç©ºé—´åˆ¶å®šäº†å¤§é‡ä¸åŒçš„æ ‡å‡†ï¼Œæ¯”å¦‚ä¸­æ–‡çš„GB2312åŠå…¶æ‰©å±•ç¼–ç GBKã€‚éšç€äº’è”ç½‘çš„å‡ºç°å’Œæ™®åŠï¼Œå„å›½ä¸åŒçš„ç¼–ç æ–¹æ¡ˆå¯¼è‡´ä¿¡æ¯äº¤æµæå…¶ä¸ä¾¿ï¼Œäºæ˜¯å‡ºç°äº†è‡´åŠ›äºç»Ÿä¸€ç¼–æ’å…¨çƒå„å›½è¯­è¨€çš„Unicodeç¼–ç ã€‚åŒä¸€æ—¶æœŸæœ‰å¦å¤–ä¸€ä¸ªå«UCSçš„å·¥ä½œç»„ä¹Ÿåœ¨å¼€å±•ç±»ä¼¼å·¥ä½œï¼Œå¹¶æ¨å‡ºäº†UCS-2ç¼–ç ï¼Œæœ€åè¢«Unicodeåˆå¹¶ï¼Œä¸”Unicodeä¿®æ­£äº†ç¼–ç ä»¥å…¼å®¹UCSã€‚

**Unicodeå’ŒUTF-8ï¼ŒUTF-16ï¼Œ UTF-32çš„åŒºåˆ«**

Unicodeåªå®šä¹‰äº†code pointï¼ˆç ç‚¹ï¼‰ï¼Œä¹Ÿå°±æ˜¯å­—ç¬¦åˆ°æ•´æ•°çš„æ˜ å°„å…³ç³»ã€‚UTF-8ï¼ŒUTF-16å’ŒUTF-32æ˜¯ä¸‰ç§å®ç°Unicodeçš„å…·ä½“ç¼–ç æ–¹æ¡ˆï¼Œè§£å†³çš„æ˜¯å¦‚ä½•ç”¨äºŒè¿›åˆ¶è¡¨ç¤ºcode pointçš„é—®é¢˜ï¼Œä¹Ÿå°±æ˜¯åœ¨å†…å­˜æˆ–è€…æ–‡ä»¶ä¸­å¦‚ä½•å­˜å‚¨ï¼Œä»¥åŠåœ¨ç½‘ç»œä¸Šä»¥ä»€ä¹ˆå½¢å¼ä¼ è¾“ç ç‚¹ä¿¡æ¯ã€‚æ‰€ä»¥è¯´Unicodeå’ŒUTF-xæ˜¯ä¸¤ä¸ªå®Œå…¨ä¸åŒçš„æ¦‚å¿µã€‚

**UTF-8ï¼ŒUTF-16å’ŒUTF-32ä¹‹é—´çš„åŒºåˆ«**

é¦–å…ˆå®ƒä»¬éƒ½æ˜¯Unicodeçš„ç¼–ç æ–¹æ¡ˆï¼ˆcoding schemeï¼‰ï¼Œä½†æ˜¯å…·ä½“çš„å®ç°æ–¹å¼å¤§ä¸ç›¸åŒã€‚æ•´ä½“ä¸Šè®²ï¼ŒUTF-32æ˜¯å®šé•¿ç¼–ç ï¼Œè€ŒUTF-8å’ŒUTF-16æ˜¯å˜é•¿ç¼–ç æ–¹æ¡ˆã€‚UTF-8æ˜¯ä¸‰è€…ä¸­å”¯ä¸€å…¼å®¹ASCIIçš„ç¼–ç æ–¹æ¡ˆã€‚

**UTF-32**

UTF-32å›ºå®šå››ä¸ªå­—èŠ‚è¡¨ç¤ºä¸€ä¸ªcode pointï¼Œç›´æ¥ç”¨äºŒè¿›åˆ¶è¡¨ç¤ºç ç‚¹ï¼Œé«˜ä½è¡¥0ã€‚å¥½å¤„æ˜¯ç¼–ç è§£ç ç‰¹åˆ«ç®€å•ï¼Œä½†æ˜¯ç°åœ¨ä¸ç”¨ï¼ŒåŸå› æ˜¯å¤ªå ç”¨å­˜å‚¨ç©ºé—´ï¼Œå°¤å…¶å¯¹äºç®€å•çš„ASCIIå­—ç¬¦ï¼Œä¹Ÿéœ€è¦ç”¨å››ä¸ªå­—èŠ‚è¡¨ç¤ºï¼Œä¸å¤ªåˆç†ã€‚

**UTF-16**

UTF-16ç¼–ç æ–¹å¼ç›¸å¯¹æ¯”è¾ƒå¤æ‚ã€‚æ—©æœŸUTF-16ä½œä¸ºUCS-2çš„æ›¿ä»£ï¼Œä¹Ÿå›ºå®šä½¿ç”¨ä¸¤ä¸ªå­—èŠ‚ï¼ˆ16bitï¼‰è¡¨ç¤ºä¸€ä¸ªç ç‚¹ï¼Œåœ¨å­—ç¬¦é›†æ¯”è¾ƒæœ‰é™çš„æƒ…å†µä¸‹å®Œå…¨å¯ä»¥æ»¡è¶³éœ€æ±‚ã€‚ä½†éšç€è¶Šæ¥è¶Šå¤šè¯­è¨€çš„åŠ å…¥ï¼Œå¯¼è‡´ä¸¤å­—èŠ‚çš„ç¼–ç ç©ºé—´ä¸å†å¤Ÿç”¨ï¼Œäºæ˜¯Unicode Consortiumæå‡ºäº†ä¸€ä¸ªæ‰©å±•UTF-16çš„æ–¹æ¡ˆï¼Œåœ¨åŸæ¥0x0000-0xFFFFçš„åŸºæœ¬è¯­è¨€å¹³é¢ï¼ˆBMPï¼‰ä¹‹å¤–åŠ å…¥äº†16ä¸ªæ–°çš„æ‰©å±•å¹³é¢ï¼Œæ¯ä¸ªå¹³é¢éƒ½åŒ…å«655356ï¼ˆ2 ^ 16)ä¸ªç ç‚¹ï¼Œè¿™æ ·ä¸€å…±æœ‰17ä¸ªå¹³é¢ï¼Œç¼–ç ç©ºé—´ä»0x0000-0x10FFFFã€‚UTF-16çš„åŸºæœ¬ç¼–ç å•å…ƒæ˜¯ä¸¤å­—èŠ‚ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œä¸€ä¸ªUnicodeçš„ç ç‚¹ç”¨UTF-16è¡¨ç¤ºå‡ºæ¥ï¼Œè¦ä¹ˆæ˜¯ä¸¤ä¸ªå­—èŠ‚ï¼Œè¦ä¹ˆæ˜¯å››ä¸ªå­—èŠ‚ã€‚é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œæ€ä¹ˆçŸ¥é“è¯¥ç”¨ä¸€ä¸ªè¿˜æ˜¯ä¸¤ä¸ªç¼–ç å•å…ƒè¿›è¡Œç¼–ç å‘¢ï¼Ÿè¿˜æœ‰è§£ç çš„æ—¶å€™å¦‚ä½•çŸ¥é“æŸä¸ªç¼–ç å•å…ƒå¯¹åº”çš„æ˜¯ä¸€ä¸ªç ç‚¹ï¼Œè¿˜æ˜¯åªæ˜¯å®Œæ•´ç ç‚¹çš„å…¶ä¸­ä¸€åŠå‘¢ï¼Ÿ

è§£å†³è¿™ä¸ªé—®é¢˜çš„æ–¹æ¡ˆéå¸¸èªæ˜ï¼Œå®ƒä»BMPä¸­é¢„ç•™äº†0xD800-0xFFFFè¿™éƒ¨åˆ†é«˜ä½ç©ºé—´ï¼Œè¯¥ç©ºé—´æœ‰ä¸ªä¸“é—¨çš„åå­—å«åšsurrogate zoneï¼Œè¿™éƒ¨åˆ†ç©ºé—´ä¸åˆ†é…ä»»ä½•å­—ç¬¦ã€‚ç„¶åå°†è¯¥ç©ºé—´å¹³å‡åˆ†æˆä¸¤ä»½ï¼Œä»0xD800å’Œ0xDC00å¼€å§‹ï¼Œåˆ†åˆ«å«high-surrogates rangeå’Œlow-surrogates rangeã€‚å¦‚æœç ç‚¹å¤§äºç­‰äº0xD8ï¼Œç¼–ç ä¸€ä¸ªcode pointå°±éœ€è¦ä¸€å¯¹å•å…ƒã€‚

high-surrogateså’Œlow-surrogates rangeä¸­çš„ç ç‚¹éƒ½å¯ä»¥ç”¨16bitè¡¨ç¤ºã€‚æŠŠoxD800å’Œ0xDC00è½¬æ¢æˆäºŒè¿›åˆ¶å°±ä¼šå‘ç°ï¼Œè¿™16ä¸ªbitä¸­æœ€é«˜6ä½éƒ½æ˜¯å›ºå®šçš„ï¼Œé‚£ä¹ˆä¸¤è€…éƒ½ä½™ä¸‹10bitçš„è‡ªç”±ç©ºé—´ï¼ŒåŠ èµ·æ¥æ˜¯20bitï¼Œåˆšå¥½èƒ½å®¹çº³16ä¸ªæ‰©å±•å¹³é¢ï¼Œå…¶ä¸­è¿™20ä¸ªbitçš„æœ€é«˜4bitè¡¨ç¤ºåœ¨å“ªä¸ªå¹³é¢ï¼Œå‰©ä¸‹16bitè¡¨ç¤ºä½äºå¹³é¢ä¸­çš„ä»€ä¹ˆä½ç½®ã€‚

å‡è®¾æŸä¸ªå­—ç¬¦ç ç‚¹ä¸ºxï¼Œä¸”x >= 0xD800, UTF-16ç¼–ç ç®—æ³•ç”¨å…¬å¼è¡¨è¾¾ä¸€ä¸‹å°±æ˜¯ï¼š

```java
x -= 0x10000; // 0x10000åˆšå¥½è¶…å‡ºåŸºæœ¬å¹³é¢0xFFFF
highSurrogate = 0xD800 + (x >>> 10);	// å°†è¶…å‡ºéƒ¨åˆ†åˆ†é…åˆ°highå’Œlow surrogateä¸­
lowSurrogate = 0xDC00 + (x & 0x3FF);
```

ä¹Ÿå°±æ˜¯è¯´ï¼ŒUTF-16æ˜¯ç”¨ä¸€å¯¹surrogateæ¥è¡¨ç¤ºå®šä¹‰åœ¨åŸºæœ¬è¯­è¨€å¹³é¢ä¹‹å¤–çš„ç ç‚¹çš„ã€‚æŒ‰ç…§ä¸Šé¢è§„åˆ™ï¼Œæ¯”å¦‚å¯¹[ä¸­æ—¥éŸ©ç»Ÿä¸€è¡¨æ„æ–‡å­—æ‰©å±•åŒºBåˆ—è¡¨](https://zh.wikipedia.org/wiki/ä¸­æ—¥éŸ©ç»Ÿä¸€è¡¨æ„æ–‡å­—æ‰©å±•åŒºBåˆ—è¡¨_(20000â€“215FF))ä¸­*ğ €–*è¿™ä¸ªå­—è¿›è¡ŒUTF-16ç¼–ç ã€‚

```java
x = 0x20016
x -= 0x10000 -> x = 0x10016
highSurrogate = oxD800 + ox40 = 0xD840
lowSurrogate = oxDC00 + 0x16 = 0xDC16
```

æ‰€ä»¥*ğ €–*çš„UTF-16ç¼–ç æ˜¯surrogate pair 0xD840 0xDC16ã€‚æ‹¿javaç¨‹åºéªŒè¯ä¸€ä¸‹ç»“æœï¼š

```java
String str = "ğ €–";
byte[] bytes = str.getBytes(StandardCharsets.UTF_16);
for(byte b : bytes) {
  System.out.printf("%3X", b);
}
```

ç»“æœæ˜¾ç¤ºFE FF D8 40 DC 16ï¼Œå’Œé¢„æœŸä¸€è‡´ã€‚å¼€å¤´çš„ä¸¤ä¸ªé­”æ•°å­—èŠ‚FE FFæ˜¯Byte Order Markï¼ˆBOMï¼‰ï¼Œç”¨æ¥æ ‡æ³¨å­—èŠ‚åºåˆ°åº•æ˜¯Big Endianå’ŒLittle Endianï¼Œä¹Ÿå°±æ˜¯é«˜ä½åœ¨å‰è¿˜æ˜¯åœ¨åã€‚æ¯”å¦‚x86æ¶æ„çš„CPUé‡‡ç”¨LEï¼Œè€Œç½‘ç»œå­—èŠ‚åºæ˜¯BEã€‚

**UTF-8**

UTF-8æ˜¯ç°åœ¨é‡‡ç”¨æœ€å¹¿æ³›çš„Unicodeç¼–ç æ–¹å¼ï¼Œå…¶ä¼˜ç‚¹åœ¨äºå¯æ‰©å±•æ€§å¼ºï¼ŒèŠ‚çœç©ºé—´ï¼Œè€Œä¸”æ— ç¼å…¼å®¹ASCIIç¼–ç ï¼ˆè¿™ç‚¹éå¸¸é‡è¦ï¼‰ã€‚ä¸Šé¢çš„UTF-16æ–¹æ¡ˆï¼Œå¦‚æœå°†æ¥æŸå¤©16ä¸ªæ‰©å±•å¹³é¢éƒ½è¢«å ç”¨äº†å°±æ²¡æœ‰åŠæ³•æŒ‰ä¸€æ ·çš„æ€è·¯ç»§ç»­æ‰©å±•äº†ï¼Œè€ŒUTF-8æœ€å¤šå¯ä»¥æ”¯æŒ6ä¸ªå­—èŠ‚ï¼Œç¼–ç ç©ºé—´éå¸¸å¤§ã€‚ä¸‹é¢è®²è®²UTF-8å˜é•¿ç¼–ç çš„å…·ä½“è§„åˆ™ã€‚

é¦–å…ˆç¬¬ä¸€ä¸ªbitå¦‚æœä»¥0å¼€å¤´ï¼Œè¯´æ˜æ€»å…±åªæœ‰ä¸€ä¸ªå­—èŠ‚ï¼Œåé¢çš„7ä¸ªbitç›´æ¥å¯¹åº”code pointã€‚ç”±äºASCIIå­—ç¬¦èŒƒå›´æ˜¯0-127ï¼Œæœ€é«˜ä½æ²¡ç”¨ä½¿ç”¨ï¼Œæ‰€ä»¥æŒ‰ç…§è¯¥æ–¹æ¡ˆï¼ŒASCIIå­—ç¬¦çš„ASCIIç¼–ç å’ŒUTF-8ç¼–ç å®Œå…¨ä¸€è‡´ã€‚

å¦‚æœç¬¬ä¸€ä¸ªbitæ˜¯1ï¼Œè¯´æ˜æœ‰å¤šä¸ªå­—èŠ‚ï¼Œå…·ä½“å¤šå°‘ä¸ªç”±ç¬¬ä¸€ä¸ªå­—èŠ‚ä¸­è¿ç»­1çš„ä¸ªæ•°å†³å®šã€‚æ¯”å¦‚11100000ï¼Œè¯´æ˜ç¼–ç æ€»å…±æœ‰3ä¸ªå­—èŠ‚ï¼ˆåŒ…å«ç¬¬ä¸€ä¸ªå­—èŠ‚ï¼‰ã€‚åç»­å­—èŠ‚éƒ½ä»¥10å¼€å¤´ï¼Œå‰©ä¸‹çš„bitæ•°ç”¨æ¥è¡¨ç¤ºå­—ç¬¦çš„code pointï¼Œæœ€é«˜ä½è¡¥0ã€‚è¿˜æ˜¯æ‹¿ä¸Šé¢çš„*ğ €–*å­—ä¸¾ä¾‹ï¼Œå…¶code pointæ˜¯0x20016, è½¬æ¢æˆäºŒè¿›åˆ¶æ˜¯

0010 0000 0000 0001 0110

å¤§è‡´ç®—ä¸€ä¸‹éœ€è¦4å­—èŠ‚æ‰å¤Ÿï¼Œå› ä¸º3å­—èŠ‚æœ€å¤šåªæœ‰16 ï¼ˆ3 * 8 - 4 - 2 - 2ï¼‰ä¸ªè‡ªç”±çš„bitå¯ä»¥ä½¿ç”¨ï¼Œè€Œè¡¨ç¤º0x20016å»æ‰å‰é¢çš„0è‡³å°‘éœ€è¦18bitã€‚æŒ‰ç…§ä¸Šè¿°è§„åˆ™ï¼Œå°†code pointæ’è¿›ä¸‹é¢4ä¸ªå­—èŠ‚ï¼š

11110xxx 10xxxxxx 10xxxxxx 10xxxxxx

ç»“æœæ˜¯

11110000 10100000 10000000 10010110

ç”¨16è¿›åˆ¶è¡¨ç¤ºå°±æ˜¯0xF0 0xA0 0x80 0x96; å†ç”¨JavaéªŒè¯ä¸€ä¸‹ï¼š

```java
String str = "ğ €–";
byte[] bytes = str.getBytes(StandardCharsets.UTF_8);
for(byte b : bytes) {
  System.out.printf("%3X", b);
}
```

ç»“æœè¾“å‡ºF0 A0 80 96ï¼Œå’Œé¢„æœŸå®Œå…¨ä¸€è‡´ã€‚

å€¼å¾—ä¸€æï¼ŒMySQLåˆ›å»ºè¡¨çš„æ—¶å€™å¯ä»¥æ˜¾å¼æŒ‡å®šå­—ç¬¦é›†ï¼Œèµ·åˆæœ‰utf8 character setï¼Œ5.5ç‰ˆæœ¬çš„æ—¶å€™åˆæ¨å‡ºäº†utf8mb4ã€‚åŸå› åœ¨äºæ—©æœŸçš„utf8å®é™…ä¸Šæ˜¯utf8mb3ï¼Œæœ€å¤šæ”¯æŒ3å­—èŠ‚æ¥å­˜å‚¨UTF-8ç¼–ç ã€‚éšç€Unicodeå­—ç¬¦é›†çš„æ‰©å±•åŸå…ˆçš„3å­—èŠ‚ä¸å¤Ÿç”¨äº†ï¼Œå°¤å…¶åœ¨å¼•å…¥Emojiä¹‹åï¼Œæ¯”å¦‚ğŸ³ï¼ˆU+1F433ï¼‰å ç”¨4ä¸ªå­—èŠ‚ï¼Œæ‰€ä»¥æ‰åœ¨æ–°ç‰ˆæœ¬ä¸­å¼•å…¥äº†å¯¹utf8mb4çš„æ”¯æŒã€‚

**Javaå¤„ç†å­—ç¬¦ä¸²**

Javaä¸­çš„charå†…éƒ¨æ˜¯ç”¨UTF-16è¡¨ç¤ºçš„ï¼Œå›ºå®šå ç”¨ä¸¤ä¸ªå­—èŠ‚ï¼Œä½†æ˜¯å®é™…ä½¿ç”¨çš„å­—ç¬¦ã€ç ç‚¹å’Œcharä¸‰è€…ä¹‹é—´éƒ½ä¸æ˜¯ä¸€ä¸€å¯¹åº”çš„ï¼Œåœ¨å¼•å…¥Emojiä¹‹åæƒ…å†µå˜å¾—æ›´ä¸ºå¤æ‚ã€‚ç”±äºæ— æ³•ç®€å•çŸ¥é“ä¸€ä¸ªå­—ç¬¦éœ€è¦ç”¨å¤šå°‘ä¸ªcharè¡¨ç¤ºï¼Œæ‰€ä»¥åœ¨è®¡ç®—Stringç±»å‹é•¿åº¦æˆ–è€…éå†Stringçš„æ—¶å€™å¹¶éæƒ³è±¡ä¸­é‚£ä¹ˆå®¹æ˜“ï¼Œç®€å•ä»¥charä¸ºå•ä½æ¥éå†å­—ç¬¦ä¸²å¯èƒ½äº§ç”Ÿä¹±ç ã€‚ï¼ˆæ³¨ï¼šè¿™é‡Œæ‰€è¯´çš„â€œå­—ç¬¦â€å‡æŒ‡å¯¹äºäººç±»æ¥è¯´æœ‰æ„ä¹‰çš„æœ€å°å•å…ƒï¼‰ã€‚

```java
import java.text.BreakIterator;
import java.util.Arrays;
import java.util.List;

public class Test {
    public static void main(String[] args) {
      	// Unicode code points of the last 3 elements:
        // U+0031 U+FE0F U+20E3
        // U+1F1E8 U+1F1F3
        // U+1F468 U+200D U+1F469 U+200D U+1F467 U+200D U+1F466
        List<String> l = Arrays.asList("abc", "ğŸ˜‚ğŸ˜ğŸ‘", "à¤•à¥à¤¤à¥", "1ï¸âƒ£", "ğŸ‡¨ğŸ‡³", "ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦");
        for (String text : l) {
            describe(text);
            for (CountType t : CountType.values()) {
                parse(t, text);
            }
        }
    }

    enum CountType {
        CHARS, CODEPOINTS, GRAPHEMES
    }

    public static void describe(String s) {
        System.out.println("********************");
        System.out.println("text: " + s);
        System.out.println("char count: " + s.length());
        System.out.println("code point count: " + s.codePointCount(0, s.length()));

        int graphemeCount = 0;
        BreakIterator it = BreakIterator.getCharacterInstance();
        it.setText(s);
        while (it.next() != BreakIterator.DONE) graphemeCount++;
        System.out.println("grapheme cluster count: " + graphemeCount);
    }

    public static void parse(CountType type, String s) {
        switch (type) {
            case CHARS:
                System.out.print(type + ": ");
                for (int i = 0; i < s.length(); i++) {
                    System.out.print(s.charAt(i) + " ");
                }
                break;
            case CODEPOINTS:
                System.out.print(type + ": ");
                s.codePoints().forEach(codePoint -> System.out.print(Character.toString(codePoint) + " "));
                break;
            case GRAPHEMES:
                System.out.print(type + ": ");
                BreakIterator it = BreakIterator.getCharacterInstance();
                it.setText(s);
                int start = it.current();
                while (it.next() != BreakIterator.DONE) {
                    System.out.print(s.substring(start, it.current()) + " ");
                    start = it.current();
                }
                break;
            default:
                throw new IllegalArgumentException("" + type);
        }
        System.out.println();
    }
}

```

è¿è¡Œç¯å¢ƒmacOS 11.0.1 + openjdk 14.0.2, ä»£ç è¾“å‡ºç»“æœå¦‚ä¸‹ï¼š

```text
text: abc
char count: 3
code point count: 3
grapheme cluster count: 3
CHARS: a b c 
CODEPOINTS: a b c 
GRAPHEMES: a b c 
********************
text: ğŸ˜‚ğŸ˜ğŸ‘
char count: 6
code point count: 3
grapheme cluster count: 3
CHARS: ? ? ? ? ? ? 
CODEPOINTS: ğŸ˜‚ ğŸ˜ ğŸ‘ 
GRAPHEMES: ğŸ˜‚ ğŸ˜ ğŸ‘ 
********************
text: à¤•à¥à¤¤à¥
char count: 4
code point count: 4
grapheme cluster count: 1
CHARS: à¤• à¥ à¤¤ à¥ 
CODEPOINTS: à¤• à¥ à¤¤ à¥ 
GRAPHEMES: à¤•à¥à¤¤à¥ 
********************
text: 1ï¸âƒ£
char count: 3
code point count: 3
grapheme cluster count: 1
CHARS: 1 ï¸ âƒ£ 
CODEPOINTS: 1 ï¸ âƒ£ 
GRAPHEMES: 1ï¸âƒ£ 
********************
text: ğŸ‡¨ğŸ‡³
char count: 4
code point count: 2
grapheme cluster count: 2
CHARS: ? ? ? ? 
CODEPOINTS: ğŸ‡¨ ğŸ‡³ 
GRAPHEMES: ğŸ‡¨ ğŸ‡³ 
********************
text: ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦
char count: 11
code point count: 7
grapheme cluster count: 7
CHARS: ? ? â€ ? ? â€ ? ? â€ ? ? 
CODEPOINTS: ğŸ‘¨ â€ ğŸ‘© â€ ğŸ‘§ â€ ğŸ‘¦ 
GRAPHEMES: ğŸ‘¨ â€ ğŸ‘© â€ ğŸ‘§ â€ ğŸ‘¦ 
```

Javaæ ‡å‡†åº“ä¸­çš„Stringç±»æä¾›äº†ä»¥charå’Œcode pointä¸ºå•ä½è¿›è¡Œéå†çš„æ”¯æŒï¼ŒCharacterç±»å¯ä»¥å¯¹Unicode code pointè¿›è¡Œè½¬åŒ–ï¼ŒBreakIteratorå¯ä»¥æŒ‰äººç±»æœ‰æ„ä¹‰çš„å­—ç¬¦å¯¹Stringè¿›è¡Œåˆ‡å‰²ã€‚ä½†åˆ†æä¸Šé¢ç»“æœå¯ä»¥å‘ç°ï¼Œå³ä½¿æ˜¯BreakIteratorå¯¹éƒ¨åˆ†Emojiå­—ç¬¦ä¹Ÿæ— èƒ½ä¸ºåŠ›ï¼Œæ¯”å¦‚ä¸­å›½å›½æ——ğŸ‡¨ğŸ‡³ï¼ˆU+1F1E8 U+1F1F3ï¼‰å’Œå…¨å®¶ç¦ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ï¼ˆU+1F468 U+200D U+1F469 U+200D U+1F467 U+200D U+1F466ï¼‰ã€‚æˆ‘ä»¬å¸Œæœ›å®ƒä»¬çš„grapheme cluster countéƒ½æ˜¯1ï¼Œä½†ç»“æœå’Œé¢„æœŸä¸åŒã€‚ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦çš„Unicodeç ç‚¹ä¸­U+200Då«åš[Zero-width Joiner](https://en.wikipedia.org/wiki/Zero-width_joiner)ï¼ŒğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦å®é™…ä¸Šæ˜¯ç”±å››ä¸ªEmojié€šè¿‡U+200Dæ‹¼æ¥è€Œæˆçš„ã€‚Javaæ ‡å‡†åº“æ²¡åŠæ³•æ­£ç¡®å¤„ç†ï¼Œæƒ³è¦å¾—åˆ°æ­£ç¡®ç»“æœè€ƒè™‘ä½¿ç”¨å¼€æºåº“[icu4j](http://site.icu-project.org/home)ã€‚

å¦å¤–å€¼å¾—ä¸€æçš„æ˜¯ï¼ŒåŒä¸€ä¸ªå­—ç¬¦åœ¨Unicodeä¸­å¯èƒ½æœ‰å¤šç§æ–¹å¼ä¸ä¹‹å¯¹åº”ï¼Œæ¯”å¦‚Ãè¿™ä¸ªå­—ç¬¦ï¼Œå¯ä»¥ç”¨U+00C1è¡¨ç¤ºï¼Œä¹Ÿå¯ä»¥ç”¨U+0041 U+0301ä»£è¡¨ã€‚è¿™ä¸¤ç§å½¢å¼ç¼–ç æˆUTF-16åç»“æœæ˜¾ç„¶ä¸åŒï¼Œæ‰€ä»¥å¦‚æœæˆ‘ä»¬å¯¹ä¸¤ä¸ªå­—ç¬¦ä¸²è¿›è¡Œæ¯”è¾ƒçš„è¯ä¼šå¾—åˆ°falseï¼Œä½†æ˜¯æˆ‘ä»¬åˆå¸Œæœ›ç»“æœæ˜¯trueã€‚Javaæ ‡å‡†åº“ä¸­çš„Normalizerç±»å¯ä»¥æŒ‰ç…§æˆ‘ä»¬æœŸæœ›çš„å¯¹å­—ç¬¦è¿›è¡ŒUnicodeæ­£è§„åŒ–ã€‚

**æ¨èé˜…è¯»**

[The Absolute Minimum Every Software Developer Absolutely, Positively Must Know About Unicode and Character Sets (No Excuses!)](https://www.joelonsoftware.com/2003/10/08/the-absolute-minimum-every-software-developer-absolutely-positively-must-know-about-unicode-and-character-sets-no-excuses/)ç®€è¿°äº†Unicodeçš„å‘å±•å²ã€‚

[Java: a rough guide to character encoding](http://illegalargumentexception.blogspot.com/2009/05/java-rough-guide-to-character-encoding.html)åˆ—ä¸¾äº†Javaå¤„ç†Unicodeå­—ç¬¦çš„å¸¸è§é”™è¯¯ã€‚
